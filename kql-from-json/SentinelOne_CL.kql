// ============================================================================
// Azure Data Explorer KQL Script for SentinelOne_CL
// ============================================================================
// Generated: 2025-09-17 06:16:07
// Table type: Custom (presumed for JSON exports)
// Schema imported from JSON export file
// ============================================================================

.create-merge table SentinelOne_CLRaw (records:dynamic)

.alter-merge table SentinelOne_CLRaw policy retention softdelete = 1d

.alter table SentinelOne_CLRaw policy caching hot = 1h

// JSON mapping - choose appropriate option based on data structure
.create-or-alter table SentinelOne_CLRaw ingestion json mapping 'SentinelOne_CLRawMapping' '[{"column":"records","Properties":{"path":"$.records"}}]'
// Alternative for direct events: '[{"column":"records","Properties":{"path":"$"}}]'

.create-merge table SentinelOne_CL(
TimeGenerated:datetime,
TenantId:guid,
agentDetectionInfo_agentIpV4_s:string,
agentDetectionInfo_agentDomain_s:string,
agentDetectionInfo_agentDetectionState_s:string,
agentDetectionInfo_accountName_s:string,
agentDetectionInfo_accountId_s:string,
threatId_s:string,
osFamily_s:string,
hash_s:string,
agentId_s:string,
agentUpdatedVersion_s:string,
targetProcessInfo_tgtProcessStartTime_t:datetime,
targetProcessInfo_tgtProcIntegrityLevel_s:string,
targetProcessInfo_tgtFilePath_s:string,
targetProcessInfo_tgtFileModifiedAt_t:datetime,
targetProcessInfo_tgtFileIsSigned_s:string,
agentDetectionInfo_agentIpV6_s:string,
agentDetectionInfo_agentLastLoggedInUserName_s:string,
agentDetectionInfo_agentMitigationMode_s:string,
agentDetectionInfo_agentOsName_s:string,
agentRealtimeInfo_agentInfected_b:bool,
agentRealtimeInfo_agentId_s:string,
agentRealtimeInfo_agentDomain_s:string,
agentRealtimeInfo_agentComputerName_s:string,
agentRealtimeInfo_activeThreats_d:real,
agentRealtimeInfo_accountName_s:string,
agentRealtimeInfo_accountId_s:string,
targetProcessInfo_tgtFileId_s:string,
agentDetectionInfo_siteName_s:string,
agentDetectionInfo_groupName_s:string,
agentDetectionInfo_groupId_s:string,
agentDetectionInfo_externalIp_s:string,
agentDetectionInfo_agentVersion_s:string,
agentDetectionInfo_agentUuid_g:string,
agentDetectionInfo_agentRegisteredAt_t:datetime,
agentDetectionInfo_agentOsRevision_s:string,
agentDetectionInfo_siteId_s:string,
targetProcessInfo_tgtFileHashSha256_s:string,
targetProcessInfo_tgtFileHashSha1_s:string,
targetProcessInfo_tgtFileCreatedAt_t:datetime,
sourceParentProcessInfo_name_s:string,
sourceParentProcessInfo_integrityLevel_s:string,
sourceParentProcessInfo_fileSignerIdentity_s:string,
sourceParentProcessInfo_filePath_s:string,
sourceParentProcessInfo_fileHashSha256_s:string,
sourceParentProcessInfo_fileHashSha1_s:string,
sourceParentProcessInfo_fileHashMd5_g:string,
sourceParentProcessInfo_pid_s:string,
sourceParentProcessInfo_commandline_s:string,
ruleInfo_severity_s:string,
ruleInfo_scopeLevel_s:string,
ruleInfo_s1ql_s:string,
ruleInfo_queryType_s:string,
ruleInfo_queryLang_s:string,
ruleInfo_name_s:string,
ruleInfo_id_s:string,
ruleInfo_treatAsThreat_s:string,
agentRealtimeInfo_agentIsActive_b:bool,
sourceParentProcessInfo_pidStarttime_t:datetime,
sourceParentProcessInfo_subsystem_s:string,
sourceProcessInfo_user_s:string,
sourceProcessInfo_uniqueId_s:string,
sourceProcessInfo_subsystem_s:string,
sourceProcessInfo_storyline_s:string,
sourceProcessInfo_pidStarttime_t:datetime,
sourceProcessInfo_pid_s:string,
sourceProcessInfo_name_s:string,
sourceParentProcessInfo_storyline_s:string,
sourceProcessInfo_integrityLevel_s:string,
sourceProcessInfo_filePath_s:string,
sourceProcessInfo_fileHashSha256_s:string,
sourceProcessInfo_fileHashSha1_s:string,
sourceProcessInfo_fileHashMd5_g:string,
sourceProcessInfo_commandline_s:string,
sourceParentProcessInfo_user_s:string,
sourceParentProcessInfo_uniqueId_s:string,
sourceProcessInfo_fileSignerIdentity_s:string,
agentRealtimeInfo_agentIsDecommissioned_b:bool,
agentRealtimeInfo_agentMachineType_s:string,
agentRealtimeInfo_agentMitigationMode_s:string,
threatInfo_sha1_s:string,
threatInfo_rebootRequired_b:bool,
threatInfo_reachedEventsLimit_b:bool,
threatInfo_publisherName_s:string,
threatInfo_processUser_s:string,
threatInfo_pendingActions_b:bool,
threatInfo_originatorProcess_s:string,
threatInfo_storyline_s:string,
threatInfo_mitigationStatusDescription_s:string,
threatInfo_mitigatedPreemptively_b:bool,
threatInfo_isValidCertificate_b:bool,
threatInfo_isFileless_b:bool,
threatInfo_initiatedByDescription_s:string,
threatInfo_initiatedBy_s:string,
threatInfo_incidentStatusDescription_s:string,
threatInfo_incidentStatus_s:string,
threatInfo_mitigationStatus_s:string,
threatInfo_identifiedAt_t:datetime,
threatInfo_threatId_s:string,
threatInfo_updatedAt_t:datetime,
tags_sentinelone_s:string,
showAlertIcon_b:bool,
serialNumber_s:string,
fullDiskScanLastUpdatedAt_t:datetime,
firstFullModeTime_t:datetime,
detectionState_s:string,
comments_s:string,
threatInfo_threatName_s:string,
description_s:string,
secondaryDescription_s:string,
activityUuid_g:string,
threatInfo_storyline_g:string,
threatInfo_threatName_g:string,
threatInfo_fileExtension_g:string,
threatInfo_maliciousProcessArguments_s:string,
whiteningOptions_s:string,
DataFields_s:string,
alertInfo_updatedAt_t:datetime,
threatInfo_fileVerificationType_s:string,
threatInfo_filePath_s:string,
agentRealtimeInfo_siteName_s:string,
agentRealtimeInfo_siteId_s:string,
agentRealtimeInfo_scanStatus_s:string,
agentRealtimeInfo_scanStartedAt_t:datetime,
agentRealtimeInfo_scanFinishedAt_t:datetime,
agentRealtimeInfo_rebootRequired_b:bool,
agentRealtimeInfo_operationalState_s:string,
agentRealtimeInfo_userActionsNeeded_s:string,
agentRealtimeInfo_networkInterfaces_s:string,
agentRealtimeInfo_groupId_s:string,
agentRealtimeInfo_agentVersion_s:string,
agentRealtimeInfo_agentUuid_g:string,
agentRealtimeInfo_agentOsType_s:string,
agentRealtimeInfo_agentOsRevision_s:string,
agentRealtimeInfo_agentOsName_s:string,
agentRealtimeInfo_agentNetworkStatus_s:string,
agentRealtimeInfo_groupName_s:string,
threatInfo_fileSize_d:real,
indicators_s:string,
threatInfo_analystVerdict_s:string,
threatInfo_fileExtensionType_s:string,
threatInfo_fileExtension_s:string,
threatInfo_failedActions_b:bool,
threatInfo_externalTicketExists_b:bool,
threatInfo_engines_s:string,
threatInfo_detectionType_s:string,
threatInfo_detectionEngines_s:string,
mitigationStatus_s:string,
threatInfo_createdAt_t:datetime,
threatInfo_collectionId_s:string,
threatInfo_cloudFilesHashVerdict_s:string,
threatInfo_classificationSource_s:string,
threatInfo_classification_s:string,
threatInfo_certificateId_s:string,
threatInfo_automaticallyResolved_b:bool,
threatInfo_analystVerdictDescription_s:string,
threatInfo_confidenceLevel_s:string,
alertInfo_source_s:string,
alertInfo_reportedAt_t:datetime,
alertInfo_isEdr_b:bool,
lastIpToMgmt_s:string,
lastActiveDate_t:datetime,
isUpToDate_b:bool,
isUninstalled_b:bool,
isPendingUninstall_b:bool,
isDecommissioned_b:bool,
isActive_b:bool,
lastLoggedInUserName_s:string,
installerType_s:string,
inRemoteShellSession_b:bool,
groupName_s:string,
groupIp_s:string,
groupId_s:string,
firewallEnabled_b:bool,
externalIp_s:string,
externalId_s:string,
infected_b:bool,
encryptedApplications_b:bool,
licenseKey_s:string,
locationType_s:string,
rangerVersion_s:string,
rangerStatus_s:string,
osType_s:string,
osStartTime_t:datetime,
osRevision_s:string,
osName_s:string,
osArch_s:string,
locationEnabled_b:bool,
operationalState_s:string,
networkQuarantineEnabled_b:bool,
networkInterfaces_s:string,
modelName_s:string,
mitigationModeSuspicious_s:string,
mitigationMode_s:string,
machineType_s:string,
locations_s:string,
networkStatus_s:string,
registeredAt_t:datetime,
domain_s:string,
cpuCount_d:real,
data_source_s:string,
data_siteName_s:string,
data_scopeName_s:string,
data_scopeLevel_s:string,
data_role_s:string,
data_fullScopeDetails_s:string,
data_accountName_s:string,
data_userScope_s:string,
createdAt_t:datetime,
accountName_s:string,
accountId_s:string,
RawData:string,
Computer:string,
ManagementGroupName:string,
MG:string,
SourceSystem:string,
activityType_d:real,
cpuId_s:string,
data_username_s:string,
primaryDescription_s:string,
coreCount_d:real,
consoleMigrationStatus_s:string,
computerName_s:string,
appsVulnerabilityStatus_s:string,
allowRemoteShell_b:bool,
agentVersion_s:string,
activeThreats_d:real,
id_s:string,
activeDirectory_lastUserMemberOf_s:string,
activeDirectory_computerMemberOf_s:string,
activeDirectory_computerDistinguishedName_s:string,
event_name_s:string,
userId_s:string,
updatedAt_t:datetime,
siteName_s:string,
siteId_s:string,
activeDirectory_lastUserDistinguishedName_s:string,
osUsername_s:string,
remoteProfilingState_s:string,
scanStartedAt_t:datetime,
agentDetectionInfo_name_s:string,
agentDetectionInfo_machineType_s:string,
targetProcessInfo_tgtProcUid_g:string,
targetProcessInfo_tgtProcStorylineId_g:string,
sourceProcessInfo_uniqueId_g:string,
sourceProcessInfo_storyline_g:string,
sourceParentProcessInfo_uniqueId_g:string,
agentDetectionInfo_osFamily_s:string,
sourceParentProcessInfo_storyline_g:string,
targetProcessInfo_tgtProcStorylineId_s:string,
targetProcessInfo_tgtProcSignedStatus_s:string,
targetProcessInfo_tgtProcPid_s:string,
targetProcessInfo_tgtProcName_s:string,
targetProcessInfo_tgtProcImagePath_s:string,
targetProcessInfo_tgtProcCmdLine_s:string,
alertInfo_srcMachineIp_s:string,
targetProcessInfo_tgtProcUid_s:string,
alertInfo_loginsUserName_s:string,
agentDetectionInfo_osName_s:string,
agentDetectionInfo_uuid_g:string,
alertInfo_incidentStatus_s:string,
alertInfo_hitType_s:string,
alertInfo_eventType_s:string,
alertInfo_dvEventId_s:string,
alertInfo_createdAt_t:datetime,
alertInfo_analystVerdict_s:string,
alertInfo_alertId_s:string,
agentDetectionInfo_osRevision_s:string,
agentRealtimeInfo_uuid_g:string,
agentRealtimeInfo_name_s:string,
agentRealtimeInfo_machineType_s:string,
agentRealtimeInfo_isDecommissioned_b:bool,
agentRealtimeInfo_isActive_b:bool,
agentRealtimeInfo_infected_b:bool,
agentRealtimeInfo_id_s:string,
agentDetectionInfo_version_s:string,
agentRealtimeInfo_os_s:string,
scanFinishedAt_t:datetime,
alertInfo_loginType_s:string,
alertInfo_loginIsAdministratorEquivalent_s:string,
targetProcessInfo_tgtFileOldPath_s:string,
alertInfo_indicatorName_s:string,
alertInfo_indicatorDescription_s:string,
type_s:string,
totalAgents_d:real,
registrationToken_s:string,
name_s:string,
alertInfo_indicatorCategory_s:string,
isDefault_b:bool,
creatorId_s:string,
creator_s:string,
uuid_g:string,
userActionsNeeded_s:string,
totalMemory_d:real,
threatRebootRequired_b:bool,
scanStatus_s:string,
inherits_b:bool,
alertInfo_loginIsSuccessful_s:string,
alertInfo_registryOldValue_g:string,
alertInfo_dstPort_s:string,
alertInfo_loginAccountSid_s:string,
alertInfo_loginAccountDomain_s:string,
alertInfo_registryValue_s:string,
ruleInfo_description_s:string,
alertInfo_registryValue_g:string,
alertInfo_registryPath_s:string,
alertInfo_registryKeyPath_s:string,
alertInfo_dstIp_s:string,
alertInfo_dnsResponse_s:string,
alertInfo_registryOldValueType_s:string,
alertInfo_registryOldValue_s:string,
targetProcessInfo_tgtFileId_g:string,
containerInfo_id_s:string,
alertInfo_srcPort_s:string,
alertInfo_srcIp_s:string,
alertInfo_netEventDirection_s:string,
alertInfo_dnsRequest_s:string,
scanAbortedAt_t:datetime,
Type:string,
_ResourceId:string,
_ItemId:string,
_ItemId:string,
_TimeReceived:datetime)

.alter table SentinelOne_CL policy caching hot = 1d

.create-or-alter function SentinelOne_CLExpand() {
SentinelOne_CLRaw
| mv-expand events = records
// Alternative for non-nested: | extend events = records
| project
TimeGenerated=todatetime(events.TimeGenerated),
TenantId=toguid(events.TenantId),
agentDetectionInfo_agentIpV4_s=tostring(events.agentDetectionInfo_agentIpV4_s),
agentDetectionInfo_agentDomain_s=tostring(events.agentDetectionInfo_agentDomain_s),
agentDetectionInfo_agentDetectionState_s=tostring(events.agentDetectionInfo_agentDetectionState_s),
agentDetectionInfo_accountName_s=tostring(events.agentDetectionInfo_accountName_s),
agentDetectionInfo_accountId_s=tostring(events.agentDetectionInfo_accountId_s),
threatId_s=tostring(events.threatId_s),
osFamily_s=tostring(events.osFamily_s),
hash_s=tostring(events.hash_s),
agentId_s=tostring(events.agentId_s),
agentUpdatedVersion_s=tostring(events.agentUpdatedVersion_s),
targetProcessInfo_tgtProcessStartTime_t=todatetime(events.targetProcessInfo_tgtProcessStartTime_t),
targetProcessInfo_tgtProcIntegrityLevel_s=tostring(events.targetProcessInfo_tgtProcIntegrityLevel_s),
targetProcessInfo_tgtFilePath_s=tostring(events.targetProcessInfo_tgtFilePath_s),
targetProcessInfo_tgtFileModifiedAt_t=todatetime(events.targetProcessInfo_tgtFileModifiedAt_t),
targetProcessInfo_tgtFileIsSigned_s=tostring(events.targetProcessInfo_tgtFileIsSigned_s),
agentDetectionInfo_agentIpV6_s=tostring(events.agentDetectionInfo_agentIpV6_s),
agentDetectionInfo_agentLastLoggedInUserName_s=tostring(events.agentDetectionInfo_agentLastLoggedInUserName_s),
agentDetectionInfo_agentMitigationMode_s=tostring(events.agentDetectionInfo_agentMitigationMode_s),
agentDetectionInfo_agentOsName_s=tostring(events.agentDetectionInfo_agentOsName_s),
agentRealtimeInfo_agentInfected_b=tobool(events.agentRealtimeInfo_agentInfected_b),
agentRealtimeInfo_agentId_s=tostring(events.agentRealtimeInfo_agentId_s),
agentRealtimeInfo_agentDomain_s=tostring(events.agentRealtimeInfo_agentDomain_s),
agentRealtimeInfo_agentComputerName_s=tostring(events.agentRealtimeInfo_agentComputerName_s),
agentRealtimeInfo_activeThreats_d=toreal(events.agentRealtimeInfo_activeThreats_d),
agentRealtimeInfo_accountName_s=tostring(events.agentRealtimeInfo_accountName_s),
agentRealtimeInfo_accountId_s=tostring(events.agentRealtimeInfo_accountId_s),
targetProcessInfo_tgtFileId_s=tostring(events.targetProcessInfo_tgtFileId_s),
agentDetectionInfo_siteName_s=tostring(events.agentDetectionInfo_siteName_s),
agentDetectionInfo_groupName_s=tostring(events.agentDetectionInfo_groupName_s),
agentDetectionInfo_groupId_s=tostring(events.agentDetectionInfo_groupId_s),
agentDetectionInfo_externalIp_s=tostring(events.agentDetectionInfo_externalIp_s),
agentDetectionInfo_agentVersion_s=tostring(events.agentDetectionInfo_agentVersion_s),
agentDetectionInfo_agentUuid_g=tostring(events.agentDetectionInfo_agentUuid_g),
agentDetectionInfo_agentRegisteredAt_t=todatetime(events.agentDetectionInfo_agentRegisteredAt_t),
agentDetectionInfo_agentOsRevision_s=tostring(events.agentDetectionInfo_agentOsRevision_s),
agentDetectionInfo_siteId_s=tostring(events.agentDetectionInfo_siteId_s),
targetProcessInfo_tgtFileHashSha256_s=tostring(events.targetProcessInfo_tgtFileHashSha256_s),
targetProcessInfo_tgtFileHashSha1_s=tostring(events.targetProcessInfo_tgtFileHashSha1_s),
targetProcessInfo_tgtFileCreatedAt_t=todatetime(events.targetProcessInfo_tgtFileCreatedAt_t),
sourceParentProcessInfo_name_s=tostring(events.sourceParentProcessInfo_name_s),
sourceParentProcessInfo_integrityLevel_s=tostring(events.sourceParentProcessInfo_integrityLevel_s),
sourceParentProcessInfo_fileSignerIdentity_s=tostring(events.sourceParentProcessInfo_fileSignerIdentity_s),
sourceParentProcessInfo_filePath_s=tostring(events.sourceParentProcessInfo_filePath_s),
sourceParentProcessInfo_fileHashSha256_s=tostring(events.sourceParentProcessInfo_fileHashSha256_s),
sourceParentProcessInfo_fileHashSha1_s=tostring(events.sourceParentProcessInfo_fileHashSha1_s),
sourceParentProcessInfo_fileHashMd5_g=tostring(events.sourceParentProcessInfo_fileHashMd5_g),
sourceParentProcessInfo_pid_s=tostring(events.sourceParentProcessInfo_pid_s),
sourceParentProcessInfo_commandline_s=tostring(events.sourceParentProcessInfo_commandline_s),
ruleInfo_severity_s=tostring(events.ruleInfo_severity_s),
ruleInfo_scopeLevel_s=tostring(events.ruleInfo_scopeLevel_s),
ruleInfo_s1ql_s=tostring(events.ruleInfo_s1ql_s),
ruleInfo_queryType_s=tostring(events.ruleInfo_queryType_s),
ruleInfo_queryLang_s=tostring(events.ruleInfo_queryLang_s),
ruleInfo_name_s=tostring(events.ruleInfo_name_s),
ruleInfo_id_s=tostring(events.ruleInfo_id_s),
ruleInfo_treatAsThreat_s=tostring(events.ruleInfo_treatAsThreat_s),
agentRealtimeInfo_agentIsActive_b=tobool(events.agentRealtimeInfo_agentIsActive_b),
sourceParentProcessInfo_pidStarttime_t=todatetime(events.sourceParentProcessInfo_pidStarttime_t),
sourceParentProcessInfo_subsystem_s=tostring(events.sourceParentProcessInfo_subsystem_s),
sourceProcessInfo_user_s=tostring(events.sourceProcessInfo_user_s),
sourceProcessInfo_uniqueId_s=tostring(events.sourceProcessInfo_uniqueId_s),
sourceProcessInfo_subsystem_s=tostring(events.sourceProcessInfo_subsystem_s),
sourceProcessInfo_storyline_s=tostring(events.sourceProcessInfo_storyline_s),
sourceProcessInfo_pidStarttime_t=todatetime(events.sourceProcessInfo_pidStarttime_t),
sourceProcessInfo_pid_s=tostring(events.sourceProcessInfo_pid_s),
sourceProcessInfo_name_s=tostring(events.sourceProcessInfo_name_s),
sourceParentProcessInfo_storyline_s=tostring(events.sourceParentProcessInfo_storyline_s),
sourceProcessInfo_integrityLevel_s=tostring(events.sourceProcessInfo_integrityLevel_s),
sourceProcessInfo_filePath_s=tostring(events.sourceProcessInfo_filePath_s),
sourceProcessInfo_fileHashSha256_s=tostring(events.sourceProcessInfo_fileHashSha256_s),
sourceProcessInfo_fileHashSha1_s=tostring(events.sourceProcessInfo_fileHashSha1_s),
sourceProcessInfo_fileHashMd5_g=tostring(events.sourceProcessInfo_fileHashMd5_g),
sourceProcessInfo_commandline_s=tostring(events.sourceProcessInfo_commandline_s),
sourceParentProcessInfo_user_s=tostring(events.sourceParentProcessInfo_user_s),
sourceParentProcessInfo_uniqueId_s=tostring(events.sourceParentProcessInfo_uniqueId_s),
sourceProcessInfo_fileSignerIdentity_s=tostring(events.sourceProcessInfo_fileSignerIdentity_s),
agentRealtimeInfo_agentIsDecommissioned_b=tobool(events.agentRealtimeInfo_agentIsDecommissioned_b),
agentRealtimeInfo_agentMachineType_s=tostring(events.agentRealtimeInfo_agentMachineType_s),
agentRealtimeInfo_agentMitigationMode_s=tostring(events.agentRealtimeInfo_agentMitigationMode_s),
threatInfo_sha1_s=tostring(events.threatInfo_sha1_s),
threatInfo_rebootRequired_b=tobool(events.threatInfo_rebootRequired_b),
threatInfo_reachedEventsLimit_b=tobool(events.threatInfo_reachedEventsLimit_b),
threatInfo_publisherName_s=tostring(events.threatInfo_publisherName_s),
threatInfo_processUser_s=tostring(events.threatInfo_processUser_s),
threatInfo_pendingActions_b=tobool(events.threatInfo_pendingActions_b),
threatInfo_originatorProcess_s=tostring(events.threatInfo_originatorProcess_s),
threatInfo_storyline_s=tostring(events.threatInfo_storyline_s),
threatInfo_mitigationStatusDescription_s=tostring(events.threatInfo_mitigationStatusDescription_s),
threatInfo_mitigatedPreemptively_b=tobool(events.threatInfo_mitigatedPreemptively_b),
threatInfo_isValidCertificate_b=tobool(events.threatInfo_isValidCertificate_b),
threatInfo_isFileless_b=tobool(events.threatInfo_isFileless_b),
threatInfo_initiatedByDescription_s=tostring(events.threatInfo_initiatedByDescription_s),
threatInfo_initiatedBy_s=tostring(events.threatInfo_initiatedBy_s),
threatInfo_incidentStatusDescription_s=tostring(events.threatInfo_incidentStatusDescription_s),
threatInfo_incidentStatus_s=tostring(events.threatInfo_incidentStatus_s),
threatInfo_mitigationStatus_s=tostring(events.threatInfo_mitigationStatus_s),
threatInfo_identifiedAt_t=todatetime(events.threatInfo_identifiedAt_t),
threatInfo_threatId_s=tostring(events.threatInfo_threatId_s),
threatInfo_updatedAt_t=todatetime(events.threatInfo_updatedAt_t),
tags_sentinelone_s=tostring(events.tags_sentinelone_s),
showAlertIcon_b=tobool(events.showAlertIcon_b),
serialNumber_s=tostring(events.serialNumber_s),
fullDiskScanLastUpdatedAt_t=todatetime(events.fullDiskScanLastUpdatedAt_t),
firstFullModeTime_t=todatetime(events.firstFullModeTime_t),
detectionState_s=tostring(events.detectionState_s),
comments_s=tostring(events.comments_s),
threatInfo_threatName_s=tostring(events.threatInfo_threatName_s),
description_s=tostring(events.description_s),
secondaryDescription_s=tostring(events.secondaryDescription_s),
activityUuid_g=tostring(events.activityUuid_g),
threatInfo_storyline_g=tostring(events.threatInfo_storyline_g),
threatInfo_threatName_g=tostring(events.threatInfo_threatName_g),
threatInfo_fileExtension_g=tostring(events.threatInfo_fileExtension_g),
threatInfo_maliciousProcessArguments_s=tostring(events.threatInfo_maliciousProcessArguments_s),
whiteningOptions_s=tostring(events.whiteningOptions_s),
DataFields_s=tostring(events.DataFields_s),
alertInfo_updatedAt_t=todatetime(events.alertInfo_updatedAt_t),
threatInfo_fileVerificationType_s=tostring(events.threatInfo_fileVerificationType_s),
threatInfo_filePath_s=tostring(events.threatInfo_filePath_s),
agentRealtimeInfo_siteName_s=tostring(events.agentRealtimeInfo_siteName_s),
agentRealtimeInfo_siteId_s=tostring(events.agentRealtimeInfo_siteId_s),
agentRealtimeInfo_scanStatus_s=tostring(events.agentRealtimeInfo_scanStatus_s),
agentRealtimeInfo_scanStartedAt_t=todatetime(events.agentRealtimeInfo_scanStartedAt_t),
agentRealtimeInfo_scanFinishedAt_t=todatetime(events.agentRealtimeInfo_scanFinishedAt_t),
agentRealtimeInfo_rebootRequired_b=tobool(events.agentRealtimeInfo_rebootRequired_b),
agentRealtimeInfo_operationalState_s=tostring(events.agentRealtimeInfo_operationalState_s),
agentRealtimeInfo_userActionsNeeded_s=tostring(events.agentRealtimeInfo_userActionsNeeded_s),
agentRealtimeInfo_networkInterfaces_s=tostring(events.agentRealtimeInfo_networkInterfaces_s),
agentRealtimeInfo_groupId_s=tostring(events.agentRealtimeInfo_groupId_s),
agentRealtimeInfo_agentVersion_s=tostring(events.agentRealtimeInfo_agentVersion_s),
agentRealtimeInfo_agentUuid_g=tostring(events.agentRealtimeInfo_agentUuid_g),
agentRealtimeInfo_agentOsType_s=tostring(events.agentRealtimeInfo_agentOsType_s),
agentRealtimeInfo_agentOsRevision_s=tostring(events.agentRealtimeInfo_agentOsRevision_s),
agentRealtimeInfo_agentOsName_s=tostring(events.agentRealtimeInfo_agentOsName_s),
agentRealtimeInfo_agentNetworkStatus_s=tostring(events.agentRealtimeInfo_agentNetworkStatus_s),
agentRealtimeInfo_groupName_s=tostring(events.agentRealtimeInfo_groupName_s),
threatInfo_fileSize_d=toreal(events.threatInfo_fileSize_d),
indicators_s=tostring(events.indicators_s),
threatInfo_analystVerdict_s=tostring(events.threatInfo_analystVerdict_s),
threatInfo_fileExtensionType_s=tostring(events.threatInfo_fileExtensionType_s),
threatInfo_fileExtension_s=tostring(events.threatInfo_fileExtension_s),
threatInfo_failedActions_b=tobool(events.threatInfo_failedActions_b),
threatInfo_externalTicketExists_b=tobool(events.threatInfo_externalTicketExists_b),
threatInfo_engines_s=tostring(events.threatInfo_engines_s),
threatInfo_detectionType_s=tostring(events.threatInfo_detectionType_s),
threatInfo_detectionEngines_s=tostring(events.threatInfo_detectionEngines_s),
mitigationStatus_s=tostring(events.mitigationStatus_s),
threatInfo_createdAt_t=todatetime(events.threatInfo_createdAt_t),
threatInfo_collectionId_s=tostring(events.threatInfo_collectionId_s),
threatInfo_cloudFilesHashVerdict_s=tostring(events.threatInfo_cloudFilesHashVerdict_s),
threatInfo_classificationSource_s=tostring(events.threatInfo_classificationSource_s),
threatInfo_classification_s=tostring(events.threatInfo_classification_s),
threatInfo_certificateId_s=tostring(events.threatInfo_certificateId_s),
threatInfo_automaticallyResolved_b=tobool(events.threatInfo_automaticallyResolved_b),
threatInfo_analystVerdictDescription_s=tostring(events.threatInfo_analystVerdictDescription_s),
threatInfo_confidenceLevel_s=tostring(events.threatInfo_confidenceLevel_s),
alertInfo_source_s=tostring(events.alertInfo_source_s),
alertInfo_reportedAt_t=todatetime(events.alertInfo_reportedAt_t),
alertInfo_isEdr_b=tobool(events.alertInfo_isEdr_b),
lastIpToMgmt_s=tostring(events.lastIpToMgmt_s),
lastActiveDate_t=todatetime(events.lastActiveDate_t),
isUpToDate_b=tobool(events.isUpToDate_b),
isUninstalled_b=tobool(events.isUninstalled_b),
isPendingUninstall_b=tobool(events.isPendingUninstall_b),
isDecommissioned_b=tobool(events.isDecommissioned_b),
isActive_b=tobool(events.isActive_b),
lastLoggedInUserName_s=tostring(events.lastLoggedInUserName_s),
installerType_s=tostring(events.installerType_s),
inRemoteShellSession_b=tobool(events.inRemoteShellSession_b),
groupName_s=tostring(events.groupName_s),
groupIp_s=tostring(events.groupIp_s),
groupId_s=tostring(events.groupId_s),
firewallEnabled_b=tobool(events.firewallEnabled_b),
externalIp_s=tostring(events.externalIp_s),
externalId_s=tostring(events.externalId_s),
infected_b=tobool(events.infected_b),
encryptedApplications_b=tobool(events.encryptedApplications_b),
licenseKey_s=tostring(events.licenseKey_s),
locationType_s=tostring(events.locationType_s),
rangerVersion_s=tostring(events.rangerVersion_s),
rangerStatus_s=tostring(events.rangerStatus_s),
osType_s=tostring(events.osType_s),
osStartTime_t=todatetime(events.osStartTime_t),
osRevision_s=tostring(events.osRevision_s),
osName_s=tostring(events.osName_s),
osArch_s=tostring(events.osArch_s),
locationEnabled_b=tobool(events.locationEnabled_b),
operationalState_s=tostring(events.operationalState_s),
networkQuarantineEnabled_b=tobool(events.networkQuarantineEnabled_b),
networkInterfaces_s=tostring(events.networkInterfaces_s),
modelName_s=tostring(events.modelName_s),
mitigationModeSuspicious_s=tostring(events.mitigationModeSuspicious_s),
mitigationMode_s=tostring(events.mitigationMode_s),
machineType_s=tostring(events.machineType_s),
locations_s=tostring(events.locations_s),
networkStatus_s=tostring(events.networkStatus_s),
registeredAt_t=todatetime(events.registeredAt_t),
domain_s=tostring(events.domain_s),
cpuCount_d=toreal(events.cpuCount_d),
data_source_s=tostring(events.data_source_s),
data_siteName_s=tostring(events.data_siteName_s),
data_scopeName_s=tostring(events.data_scopeName_s),
data_scopeLevel_s=tostring(events.data_scopeLevel_s),
data_role_s=tostring(events.data_role_s),
data_fullScopeDetails_s=tostring(events.data_fullScopeDetails_s),
data_accountName_s=tostring(events.data_accountName_s),
data_userScope_s=tostring(events.data_userScope_s),
createdAt_t=todatetime(events.createdAt_t),
accountName_s=tostring(events.accountName_s),
accountId_s=tostring(events.accountId_s),
RawData=tostring(events.RawData),
Computer=tostring(events.Computer),
ManagementGroupName=tostring(events.ManagementGroupName),
MG=tostring(events.MG),
SourceSystem=tostring(events.SourceSystem),
activityType_d=toreal(events.activityType_d),
cpuId_s=tostring(events.cpuId_s),
data_username_s=tostring(events.data_username_s),
primaryDescription_s=tostring(events.primaryDescription_s),
coreCount_d=toreal(events.coreCount_d),
consoleMigrationStatus_s=tostring(events.consoleMigrationStatus_s),
computerName_s=tostring(events.computerName_s),
appsVulnerabilityStatus_s=tostring(events.appsVulnerabilityStatus_s),
allowRemoteShell_b=tobool(events.allowRemoteShell_b),
agentVersion_s=tostring(events.agentVersion_s),
activeThreats_d=toreal(events.activeThreats_d),
id_s=tostring(events.id_s),
activeDirectory_lastUserMemberOf_s=tostring(events.activeDirectory_lastUserMemberOf_s),
activeDirectory_computerMemberOf_s=tostring(events.activeDirectory_computerMemberOf_s),
activeDirectory_computerDistinguishedName_s=tostring(events.activeDirectory_computerDistinguishedName_s),
event_name_s=tostring(events.event_name_s),
userId_s=tostring(events.userId_s),
updatedAt_t=todatetime(events.updatedAt_t),
siteName_s=tostring(events.siteName_s),
siteId_s=tostring(events.siteId_s),
activeDirectory_lastUserDistinguishedName_s=tostring(events.activeDirectory_lastUserDistinguishedName_s),
osUsername_s=tostring(events.osUsername_s),
remoteProfilingState_s=tostring(events.remoteProfilingState_s),
scanStartedAt_t=todatetime(events.scanStartedAt_t),
agentDetectionInfo_name_s=tostring(events.agentDetectionInfo_name_s),
agentDetectionInfo_machineType_s=tostring(events.agentDetectionInfo_machineType_s),
targetProcessInfo_tgtProcUid_g=tostring(events.targetProcessInfo_tgtProcUid_g),
targetProcessInfo_tgtProcStorylineId_g=tostring(events.targetProcessInfo_tgtProcStorylineId_g),
sourceProcessInfo_uniqueId_g=tostring(events.sourceProcessInfo_uniqueId_g),
sourceProcessInfo_storyline_g=tostring(events.sourceProcessInfo_storyline_g),
sourceParentProcessInfo_uniqueId_g=tostring(events.sourceParentProcessInfo_uniqueId_g),
agentDetectionInfo_osFamily_s=tostring(events.agentDetectionInfo_osFamily_s),
sourceParentProcessInfo_storyline_g=tostring(events.sourceParentProcessInfo_storyline_g),
targetProcessInfo_tgtProcStorylineId_s=tostring(events.targetProcessInfo_tgtProcStorylineId_s),
targetProcessInfo_tgtProcSignedStatus_s=tostring(events.targetProcessInfo_tgtProcSignedStatus_s),
targetProcessInfo_tgtProcPid_s=tostring(events.targetProcessInfo_tgtProcPid_s),
targetProcessInfo_tgtProcName_s=tostring(events.targetProcessInfo_tgtProcName_s),
targetProcessInfo_tgtProcImagePath_s=tostring(events.targetProcessInfo_tgtProcImagePath_s),
targetProcessInfo_tgtProcCmdLine_s=tostring(events.targetProcessInfo_tgtProcCmdLine_s),
alertInfo_srcMachineIp_s=tostring(events.alertInfo_srcMachineIp_s),
targetProcessInfo_tgtProcUid_s=tostring(events.targetProcessInfo_tgtProcUid_s),
alertInfo_loginsUserName_s=tostring(events.alertInfo_loginsUserName_s),
agentDetectionInfo_osName_s=tostring(events.agentDetectionInfo_osName_s),
agentDetectionInfo_uuid_g=tostring(events.agentDetectionInfo_uuid_g),
alertInfo_incidentStatus_s=tostring(events.alertInfo_incidentStatus_s),
alertInfo_hitType_s=tostring(events.alertInfo_hitType_s),
alertInfo_eventType_s=tostring(events.alertInfo_eventType_s),
alertInfo_dvEventId_s=tostring(events.alertInfo_dvEventId_s),
alertInfo_createdAt_t=todatetime(events.alertInfo_createdAt_t),
alertInfo_analystVerdict_s=tostring(events.alertInfo_analystVerdict_s),
alertInfo_alertId_s=tostring(events.alertInfo_alertId_s),
agentDetectionInfo_osRevision_s=tostring(events.agentDetectionInfo_osRevision_s),
agentRealtimeInfo_uuid_g=tostring(events.agentRealtimeInfo_uuid_g),
agentRealtimeInfo_name_s=tostring(events.agentRealtimeInfo_name_s),
agentRealtimeInfo_machineType_s=tostring(events.agentRealtimeInfo_machineType_s),
agentRealtimeInfo_isDecommissioned_b=tobool(events.agentRealtimeInfo_isDecommissioned_b),
agentRealtimeInfo_isActive_b=tobool(events.agentRealtimeInfo_isActive_b),
agentRealtimeInfo_infected_b=tobool(events.agentRealtimeInfo_infected_b),
agentRealtimeInfo_id_s=tostring(events.agentRealtimeInfo_id_s),
agentDetectionInfo_version_s=tostring(events.agentDetectionInfo_version_s),
agentRealtimeInfo_os_s=tostring(events.agentRealtimeInfo_os_s),
scanFinishedAt_t=todatetime(events.scanFinishedAt_t),
alertInfo_loginType_s=tostring(events.alertInfo_loginType_s),
alertInfo_loginIsAdministratorEquivalent_s=tostring(events.alertInfo_loginIsAdministratorEquivalent_s),
targetProcessInfo_tgtFileOldPath_s=tostring(events.targetProcessInfo_tgtFileOldPath_s),
alertInfo_indicatorName_s=tostring(events.alertInfo_indicatorName_s),
alertInfo_indicatorDescription_s=tostring(events.alertInfo_indicatorDescription_s),
type_s=tostring(events.type_s),
totalAgents_d=toreal(events.totalAgents_d),
registrationToken_s=tostring(events.registrationToken_s),
name_s=tostring(events.name_s),
alertInfo_indicatorCategory_s=tostring(events.alertInfo_indicatorCategory_s),
isDefault_b=tobool(events.isDefault_b),
creatorId_s=tostring(events.creatorId_s),
creator_s=tostring(events.creator_s),
uuid_g=tostring(events.uuid_g),
userActionsNeeded_s=tostring(events.userActionsNeeded_s),
totalMemory_d=toreal(events.totalMemory_d),
threatRebootRequired_b=tobool(events.threatRebootRequired_b),
scanStatus_s=tostring(events.scanStatus_s),
inherits_b=tobool(events.inherits_b),
alertInfo_loginIsSuccessful_s=tostring(events.alertInfo_loginIsSuccessful_s),
alertInfo_registryOldValue_g=tostring(events.alertInfo_registryOldValue_g),
alertInfo_dstPort_s=tostring(events.alertInfo_dstPort_s),
alertInfo_loginAccountSid_s=tostring(events.alertInfo_loginAccountSid_s),
alertInfo_loginAccountDomain_s=tostring(events.alertInfo_loginAccountDomain_s),
alertInfo_registryValue_s=tostring(events.alertInfo_registryValue_s),
ruleInfo_description_s=tostring(events.ruleInfo_description_s),
alertInfo_registryValue_g=tostring(events.alertInfo_registryValue_g),
alertInfo_registryPath_s=tostring(events.alertInfo_registryPath_s),
alertInfo_registryKeyPath_s=tostring(events.alertInfo_registryKeyPath_s),
alertInfo_dstIp_s=tostring(events.alertInfo_dstIp_s),
alertInfo_dnsResponse_s=tostring(events.alertInfo_dnsResponse_s),
alertInfo_registryOldValueType_s=tostring(events.alertInfo_registryOldValueType_s),
alertInfo_registryOldValue_s=tostring(events.alertInfo_registryOldValue_s),
targetProcessInfo_tgtFileId_g=tostring(events.targetProcessInfo_tgtFileId_g),
containerInfo_id_s=tostring(events.containerInfo_id_s),
alertInfo_srcPort_s=tostring(events.alertInfo_srcPort_s),
alertInfo_srcIp_s=tostring(events.alertInfo_srcIp_s),
alertInfo_netEventDirection_s=tostring(events.alertInfo_netEventDirection_s),
alertInfo_dnsRequest_s=tostring(events.alertInfo_dnsRequest_s),
scanAbortedAt_t=todatetime(events.scanAbortedAt_t),
Type=tostring(events.Type),
_ResourceId=tostring(events._ResourceId),
_ItemId=tostring(events._ItemId),
_ItemId=tostring(events._ItemId),
_TimeReceived=todatetime(now())
}

.alter table SentinelOne_CL policy update @'[{"Source": "SentinelOne_CLRaw", "Query": "SentinelOne_CLExpand()", "IsEnabled": "True", "IsTransactional": true}]'
