// ============================================================================
// Azure Data Explorer KQL Script for OCI_Logs_CL
// ============================================================================
// Generated: 2025-09-13 20:17:16
// Table type: Custom (presumed for JSON exports)
// Schema imported from JSON export file
// ============================================================================

.create-merge table OCI_Logs_CLRaw (records:dynamic)

.alter-merge table OCI_Logs_CLRaw policy retention softdelete = 1d

.alter table OCI_Logs_CLRaw policy caching hot = 1h

// JSON mapping - choose appropriate option based on data structure
.create-or-alter table OCI_Logs_CLRaw ingestion json mapping 'OCI_Logs_CLRawMapping' '[{"column":"records","Properties":{"path":"$.records"}}]'
// Alternative for direct events: '[{"column":"records","Properties":{"path":"$"}}]'

.create-merge table OCI_Logs_CL(
TimeGenerated:datetime,
data_endTime_d:real,
data_identity_credentials_s:string,
data_identity_principalName_s:string,
data_request_headers_Accept_s:string,
data_request_headers_Accept_Encoding_s:string,
data_request_headers_Accept_Language_s:string,
data_request_headers_Origin_s:string,
data_request_headers_Referer_s:string,
data_request_headers_X_OCI_LB_NetworkMetadata_s:string,
data_request_headers_X_Real_IP_s:string,
data_request_headers_X_Real_Port_s:string,
data_request_headers_oci_original_url_s:string,
data_request_headers_oci_skip_authorization_for_splat_s:string,
data_request_headers_opc_principal_s:string,
data_request_headers_x_date_s:string,
data_request_parameters_compartmentId_s:string,
data_response_headers_Access_Control_Allow_Credentials_s:string,
data_response_headers_Access_Control_Allow_Origin_s:string,
data_response_headers_Access_Control_Expose_Headers_s:string,
data_request_parameters_limit_s:string,
data_request_headers_oci_splat_audited_s:string,
data_request_headers_oci_splat_internal_context_s:string,
data_request_parameters_sortBy_s:string,
data_request_parameters_sortOrder_s:string,
data_additionalDetails_X_Real_Port_d:real,
data_freeformTags_VCN_s:string,
data_request_headers_Authorization_s:string,
data_request_headers_Sec_Fetch_Dest_s:string,
data_request_headers_Sec_Fetch_Mode_s:string,
data_request_headers_Sec_Fetch_Site_s:string,
data_identity_consoleSessionId_s:string,
data_request_headers_sec_ch_ua_s:string,
data_identity_authType_s:string,
type_s:string,
data_identity_userAgent_s:string,
data_message_s:string,
data_request_action_s:string,
data_request_headers_Connection_s:string,
data_request_headers_User_Agent_s:string,
data_request_headers_X_Forwarded_For_s:string,
data_request_headers_auth_info_s:string,
data_request_headers_opc_request_id_s:string,
data_request_id_s:string,
data_request_parameters_tenancy_s:string,
data_request_path_s:string,
data_resourceId_s:string,
data_response_headers_Content_Length_s:string,
data_response_headers_Content_Type_s:string,
data_response_headers_Date_s:string,
data_response_headers_ETag_s:string,
data_response_headers_Vary_s:string,
data_response_headers_opc_request_id_s:string,
data_response_responseTime_t:datetime,
data_response_status_s:string,
dataschema_s:string,
id_g:string,
oracle_compartmentid_s:string,
oracle_ingestedtime_t:datetime,
oracle_loggroupid_s:string,
oracle_tenantid_s:string,
source_s:string,
specversion_s:string,
time_t:datetime,
data_eventGroupingId_g:string,
data_request_headers_sec_ch_ua_mobile_s:string,
data_response_headers_Connection_s:string,
data_response_headers_Timing_Allow_Origin_s:string,
data_response_headers_Transfer_Encoding_s:string,
data_request_parameters_accessLevel_s:string,
data_request_parameters_compartmentIdInSubtree_s:string,
data_additionalDetails_description_s:string,
data_additionalDetails_isAccessable_b:bool,
data_additionalDetails_lifeCycleState_s:string,
data_additionalDetails_homeRegionKey_s:string,
data_additionalDetails_oracleMyServicesIdentifier_s:string,
data_request_headers_X_Forwarded_Host_s:string,
data_request_headers_X_Forwarded_Port_s:string,
data_request_headers_X_Forwarded_Proto_s:string,
data_request_headers_X_Oracle_Auth_Client_CN_s:string,
data_request_parameters_isBanner_s:string,
data_request_parameters_granularity_s:string,
data_request_parameters_protocol_s:string,
data_additionalDetails_userId_s:string,
data_response_headers_Location_s:string,
data_stateChange_current_fingerprint_s:string,
data_stateChange_current_keyId_s:string,
data_stateChange_current_keyValue_s:string,
data_stateChange_current_lifecycleState_s:string,
data_stateChange_current_timeCreated_t:datetime,
data_stateChange_current_userId_s:string,
data_request_parameters_userId_s:string,
data_request_headers_X_OCI_LB_PrivateAccessMetadata_s:string,
data_request_headers_date_s:string,
data_stateChange_current_LoadBalancers_s:string,
data_request_parameters_fields_s:string,
data_request_parameters_availabilityDomain_s:string,
data_response_headers_Pragma_s:string,
data_response_headers_Cache_Control_s:string,
data_request_parameters_param0_s:string,
data_additionalDetails_namespace_s:string,
data_response_headers_X_Content_Type_Options_s:string,
data_request_headers_Content_Length_s:string,
data_request_headers_Content_Type_s:string,
data_request_headers_x_content_sha256_s:string,
data_request_headers_If_None_Match_s:string,
data_response_headers_Content_Encoding_s:string,
data_request_parameters_includeSubcompartments_s:string,
data_response_headers_opc_limit_s:string,
data_request_headers_Date_s:string,
data_request_headers_opc_client_info_s:string,
data_request_parameters_endTime_s:string,
data_request_parameters_startTime_s:string,
data_response_headers_opc_next_page_s:string,
data_response_headers_opc_prev_page_s:string,
data_identity_tenantId_s:string,
data_request_parameters_id_s:string,
data_request_parameters_name_s:string,
data_request_parameters_page_s:string,
data_request_parameters_streamPoolId_s:string,
data_response_headers_opc_previous_page_s:string,
data_response_payload_id_s:string,
data_response_payload_resourceName_s:string,
data_request_headers_accept_language_s:string,
data_request_headers_authorization_s:string,
data_response_headers_access_control_allow_credentials_s:string,
data_response_headers_access_control_allow_methods_s:string,
data_response_headers_access_control_allow_origin_s:string,
data_response_headers_access_control_expose_headers_s:string,
data_response_headers_date_s:string,
data_response_headers_x_api_id_s:string,
data_request_parameters_lifecycleState_s:string,
data_identity_principalId_s:string,
data_identity_ipAddress_s:string,
data_eventName_s:string,
data_stateChange_current_agentConfig_isMonitoringDisabled_b:bool,
data_stateChange_current_agentConfig_pluginsConfig_s:string,
data_stateChange_current_availabilityConfig_recoveryAction_s:string,
data_stateChange_current_availabilityDomain_s:string,
data_stateChange_current_faultDomain_s:string,
data_stateChange_current_imageId_s:string,
data_stateChange_current_instanceOptions_areLegacyImdsEndpointsDisabled_b:bool,
data_stateChange_current_launchMode_s:string,
data_stateChange_current_launchOptions_bootVolumeType_s:string,
data_stateChange_current_launchOptions_firmware_s:string,
data_stateChange_current_launchOptions_isConsistentVolumeNamingEnabled_b:bool,
data_stateChange_current_launchOptions_isPvEncryptionInTransitEnabled_b:bool,
data_stateChange_current_launchOptions_networkType_s:string,
data_stateChange_current_launchOptions_remoteDataVolumeType_s:string,
data_stateChange_current_metadata_ssh_authorized_keys_s:string,
data_stateChange_current_region_s:string,
data_stateChange_current_shape_s:string,
data_stateChange_current_shapeConfig_gpus_d:real,
data_stateChange_current_shapeConfig_localDisks_d:real,
data_stateChange_current_shapeConfig_maxVnicAttachments_d:real,
data_stateChange_current_shapeConfig_memoryInGBs_d:real,
data_stateChange_current_shapeConfig_networkingBandwidthInGbps_d:real,
data_stateChange_current_shapeConfig_ocpus_d:real,
data_stateChange_current_shapeConfig_processorDescription_s:string,
data_stateChange_current_sourceDetails_imageId_s:string,
data_stateChange_current_sourceDetails_sourceType_s:string,
data_stateChange_current_systemTags_orcl_cloud_s:string,
data_request_parameters_instanceId_s:string,
data_request_headers_opc_retry_token_s:string,
data_stateChange_current_agentConfig_isManagementDisabled_b:bool,
data_stateChange_current_agentConfig_areAllPluginsDisabled_b:bool,
data_additionalDetails_volumeId_s:string,
data_additionalDetails_type_s:string,
data_flowid_s:string,
data_startTime_d:real,
data_status_s:string,
data_version_s:string,
id_s:string,
oracle_logid_s:string,
oracle_vniccompartmentocid_s:string,
oracle_vnicocid_s:string,
oracle_vnicsubnetocid_s:string,
data_action_s:string,
data_bytesOut_d:real,
data_destinationAddress_s:string,
data_destinationPort_d:real,
data_packets_d:real,
data_additionalDetails_isFreeTier_b:bool,
data_protocol_d:real,
data_sourceAddress_s:string,
data_sourcePort_d:real,
data_request_parameters_serviceName_s:string,
data_request_parameters_vcnId_s:string,
data_request_parameters_imageId_s:string,
data_request_parameters_operatingSystem_s:string,
data_request_parameters_operatingSystemVersion_s:string,
data_request_parameters_shape_s:string,
data_request_parameters_isMergeEnabled_s:string,
data_identity_callerId_s:string,
data_identity_callerName_s:string,
data_request_headers_opc_obo_token_s:string,
data_additionalDetails_imageId_s:string,
data_additionalDetails_shape_s:string,
data_protocolName_s:string,
data_request_parameters_subnetId_s:string,
data_stateChange_current_Instance_agentConfig_s:string,
data_stateChange_current_Instance_availabilityDomain_s:string,
data_stateChange_current_lifecycleDetails_s:string,
data_stateChange_current_lifecyleDetails_s:string,
data_stateChange_current_tenancyId_s:string,
data_stateChange_current_timeUpdated_t:datetime,
data_stateChange_current_userDisplayName_s:string,
data_stateChange_current_userName_s:string,
data_request_headers_oci_splat_generated_ocids_s:string,
data_response_headers_opc_work_request_id_s:string,
data_stateChange_current_configuration_s:string,
data_stateChange_current_definedTags_s:string,
data_stateChange_current_freeformTags_s:string,
data_stateChange_current_isEnabled_s:string,
data_stateChange_current_logGroupId_s:string,
data_stateChange_current_logType_s:string,
data_stateChange_current_retentionDuration_s:string,
data_stateChange_current_timeCreated_s:string,
data_stateChange_current_timeLastModified_s:string,
data_request_headers_Cache_Control_s:string,
data_request_headers_Cookie_s:string,
data_request_headers_Sec_Fetch_User_s:string,
data_request_headers_Upgrade_Insecure_Requests_s:string,
data_response_headers_X_FRAME_OPTIONS_s:string,
data_additionalDetails_id_s:string,
data_availabilityDomain_s:string,
data_compartmentId_s:string,
data_compartmentName_s:string,
data_definedTags_Oracle_Tags_CreatedBy_s:string,
data_definedTags_Oracle_Tags_CreatedOn_t:datetime,
data_eventGroupingId_s:string,
data_stateChange_current_instanceId_s:string,
data_stateChange_current_id_s:string,
data_stateChange_current_displayName_s:string,
data_stateChange_current_definedTags_Oracle_Tags_s:string,
data_stateChange_current_Instance_compartmentId_s:string,
data_stateChange_current_Instance_definedTags_s:string,
data_stateChange_current_Instance_displayName_s:string,
data_stateChange_current_Instance_extendedMetadata_s:string,
data_stateChange_current_Instance_faultDomain_s:string,
data_stateChange_current_Instance_freeformTags_s:string,
data_stateChange_current_Instance_id_s:string,
data_stateChange_current_Instance_imageId_s:string,
data_stateChange_current_Instance_instanceOptions_s:string,
data_stateChange_current_Instance_launchMode_s:string,
data_stateChange_current_Instance_launchOptions_s:string,
data_stateChange_current_Instance_lifecycleState_s:string,
data_stateChange_current_Instance_metadata_s:string,
data_stateChange_current_Instance_region_s:string,
data_stateChange_current_Instance_availabilityConfig_s:string,
data_stateChange_current_Instance_shape_s:string,
data_stateChange_current_Instance_sourceDetails_s:string,
data_stateChange_current_Instance_systemTags_s:string,
data_stateChange_current_Instance_timeCreated_t:datetime,
data_stateChange_current_subnetIds_s:string,
data_stateChange_current_syslogUrl_s:string,
data_stateChange_current_traceConfig_domainId_s:string,
data_stateChange_current_traceConfig_isEnabled_b:bool,
data_response_headers_Content_Security_Policy_s:string,
data_response_headers_Etag_s:string,
data_response_headers_Opc_Request_Id_s:string,
data_response_headers_Strict_Transport_Security_s:string,
data_response_headers_X_Frame_Options_s:string,
data_response_headers_X_Xss_Protection_s:string,
data_stateChange_current_compartmentId_s:string,
data_stateChange_current_Instance_shapeConfig_s:string,
data_response_headers_oci_splat_authorization_verify_content_s:string,
_TimeReceived:datetime)

.alter table OCI_Logs_CL policy caching hot = 1d

.create-or-alter function OCI_Logs_CLExpand() {
OCI_Logs_CLRaw
| mv-expand events = records
// Alternative for non-nested: | extend events = records
| project
TimeGenerated=todatetime(events.TimeGenerated),
data_endTime_d=toreal(events.data_endTime_d),
data_identity_credentials_s=tostring(events.data_identity_credentials_s),
data_identity_principalName_s=tostring(events.data_identity_principalName_s),
data_request_headers_Accept_s=tostring(events.data_request_headers_Accept_s),
data_request_headers_Accept_Encoding_s=tostring(events.data_request_headers_Accept_Encoding_s),
data_request_headers_Accept_Language_s=tostring(events.data_request_headers_Accept_Language_s),
data_request_headers_Origin_s=tostring(events.data_request_headers_Origin_s),
data_request_headers_Referer_s=tostring(events.data_request_headers_Referer_s),
data_request_headers_X_OCI_LB_NetworkMetadata_s=tostring(events.data_request_headers_X_OCI_LB_NetworkMetadata_s),
data_request_headers_X_Real_IP_s=tostring(events.data_request_headers_X_Real_IP_s),
data_request_headers_X_Real_Port_s=tostring(events.data_request_headers_X_Real_Port_s),
data_request_headers_oci_original_url_s=tostring(events.data_request_headers_oci_original_url_s),
data_request_headers_oci_skip_authorization_for_splat_s=tostring(events.data_request_headers_oci_skip_authorization_for_splat_s),
data_request_headers_opc_principal_s=tostring(events.data_request_headers_opc_principal_s),
data_request_headers_x_date_s=tostring(events.data_request_headers_x_date_s),
data_request_parameters_compartmentId_s=tostring(events.data_request_parameters_compartmentId_s),
data_response_headers_Access_Control_Allow_Credentials_s=tostring(events.data_response_headers_Access_Control_Allow_Credentials_s),
data_response_headers_Access_Control_Allow_Origin_s=tostring(events.data_response_headers_Access_Control_Allow_Origin_s),
data_response_headers_Access_Control_Expose_Headers_s=tostring(events.data_response_headers_Access_Control_Expose_Headers_s),
data_request_parameters_limit_s=tostring(events.data_request_parameters_limit_s),
data_request_headers_oci_splat_audited_s=tostring(events.data_request_headers_oci_splat_audited_s),
data_request_headers_oci_splat_internal_context_s=tostring(events.data_request_headers_oci_splat_internal_context_s),
data_request_parameters_sortBy_s=tostring(events.data_request_parameters_sortBy_s),
data_request_parameters_sortOrder_s=tostring(events.data_request_parameters_sortOrder_s),
data_additionalDetails_X_Real_Port_d=toreal(events.data_additionalDetails_X_Real_Port_d),
data_freeformTags_VCN_s=tostring(events.data_freeformTags_VCN_s),
data_request_headers_Authorization_s=tostring(events.data_request_headers_Authorization_s),
data_request_headers_Sec_Fetch_Dest_s=tostring(events.data_request_headers_Sec_Fetch_Dest_s),
data_request_headers_Sec_Fetch_Mode_s=tostring(events.data_request_headers_Sec_Fetch_Mode_s),
data_request_headers_Sec_Fetch_Site_s=tostring(events.data_request_headers_Sec_Fetch_Site_s),
data_identity_consoleSessionId_s=tostring(events.data_identity_consoleSessionId_s),
data_request_headers_sec_ch_ua_s=tostring(events.data_request_headers_sec_ch_ua_s),
data_identity_authType_s=tostring(events.data_identity_authType_s),
type_s=tostring(events.type_s),
data_identity_userAgent_s=tostring(events.data_identity_userAgent_s),
data_message_s=tostring(events.data_message_s),
data_request_action_s=tostring(events.data_request_action_s),
data_request_headers_Connection_s=tostring(events.data_request_headers_Connection_s),
data_request_headers_User_Agent_s=tostring(events.data_request_headers_User_Agent_s),
data_request_headers_X_Forwarded_For_s=tostring(events.data_request_headers_X_Forwarded_For_s),
data_request_headers_auth_info_s=tostring(events.data_request_headers_auth_info_s),
data_request_headers_opc_request_id_s=tostring(events.data_request_headers_opc_request_id_s),
data_request_id_s=tostring(events.data_request_id_s),
data_request_parameters_tenancy_s=tostring(events.data_request_parameters_tenancy_s),
data_request_path_s=tostring(events.data_request_path_s),
data_resourceId_s=tostring(events.data_resourceId_s),
data_response_headers_Content_Length_s=tostring(events.data_response_headers_Content_Length_s),
data_response_headers_Content_Type_s=tostring(events.data_response_headers_Content_Type_s),
data_response_headers_Date_s=tostring(events.data_response_headers_Date_s),
data_response_headers_ETag_s=tostring(events.data_response_headers_ETag_s),
data_response_headers_Vary_s=tostring(events.data_response_headers_Vary_s),
data_response_headers_opc_request_id_s=tostring(events.data_response_headers_opc_request_id_s),
data_response_responseTime_t=todatetime(events.data_response_responseTime_t),
data_response_status_s=tostring(events.data_response_status_s),
dataschema_s=tostring(events.dataschema_s),
id_g=tostring(events.id_g),
oracle_compartmentid_s=tostring(events.oracle_compartmentid_s),
oracle_ingestedtime_t=todatetime(events.oracle_ingestedtime_t),
oracle_loggroupid_s=tostring(events.oracle_loggroupid_s),
oracle_tenantid_s=tostring(events.oracle_tenantid_s),
source_s=tostring(events.source_s),
specversion_s=tostring(events.specversion_s),
time_t=todatetime(events.time_t),
data_eventGroupingId_g=tostring(events.data_eventGroupingId_g),
data_request_headers_sec_ch_ua_mobile_s=tostring(events.data_request_headers_sec_ch_ua_mobile_s),
data_response_headers_Connection_s=tostring(events.data_response_headers_Connection_s),
data_response_headers_Timing_Allow_Origin_s=tostring(events.data_response_headers_Timing_Allow_Origin_s),
data_response_headers_Transfer_Encoding_s=tostring(events.data_response_headers_Transfer_Encoding_s),
data_request_parameters_accessLevel_s=tostring(events.data_request_parameters_accessLevel_s),
data_request_parameters_compartmentIdInSubtree_s=tostring(events.data_request_parameters_compartmentIdInSubtree_s),
data_additionalDetails_description_s=tostring(events.data_additionalDetails_description_s),
data_additionalDetails_isAccessable_b=tobool(events.data_additionalDetails_isAccessable_b),
data_additionalDetails_lifeCycleState_s=tostring(events.data_additionalDetails_lifeCycleState_s),
data_additionalDetails_homeRegionKey_s=tostring(events.data_additionalDetails_homeRegionKey_s),
data_additionalDetails_oracleMyServicesIdentifier_s=tostring(events.data_additionalDetails_oracleMyServicesIdentifier_s),
data_request_headers_X_Forwarded_Host_s=tostring(events.data_request_headers_X_Forwarded_Host_s),
data_request_headers_X_Forwarded_Port_s=tostring(events.data_request_headers_X_Forwarded_Port_s),
data_request_headers_X_Forwarded_Proto_s=tostring(events.data_request_headers_X_Forwarded_Proto_s),
data_request_headers_X_Oracle_Auth_Client_CN_s=tostring(events.data_request_headers_X_Oracle_Auth_Client_CN_s),
data_request_parameters_isBanner_s=tostring(events.data_request_parameters_isBanner_s),
data_request_parameters_granularity_s=tostring(events.data_request_parameters_granularity_s),
data_request_parameters_protocol_s=tostring(events.data_request_parameters_protocol_s),
data_additionalDetails_userId_s=tostring(events.data_additionalDetails_userId_s),
data_response_headers_Location_s=tostring(events.data_response_headers_Location_s),
data_stateChange_current_fingerprint_s=tostring(events.data_stateChange_current_fingerprint_s),
data_stateChange_current_keyId_s=tostring(events.data_stateChange_current_keyId_s),
data_stateChange_current_keyValue_s=tostring(events.data_stateChange_current_keyValue_s),
data_stateChange_current_lifecycleState_s=tostring(events.data_stateChange_current_lifecycleState_s),
data_stateChange_current_timeCreated_t=todatetime(events.data_stateChange_current_timeCreated_t),
data_stateChange_current_userId_s=tostring(events.data_stateChange_current_userId_s),
data_request_parameters_userId_s=tostring(events.data_request_parameters_userId_s),
data_request_headers_X_OCI_LB_PrivateAccessMetadata_s=tostring(events.data_request_headers_X_OCI_LB_PrivateAccessMetadata_s),
data_request_headers_date_s=tostring(events.data_request_headers_date_s),
data_stateChange_current_LoadBalancers_s=tostring(events.data_stateChange_current_LoadBalancers_s),
data_request_parameters_fields_s=tostring(events.data_request_parameters_fields_s),
data_request_parameters_availabilityDomain_s=tostring(events.data_request_parameters_availabilityDomain_s),
data_response_headers_Pragma_s=tostring(events.data_response_headers_Pragma_s),
data_response_headers_Cache_Control_s=tostring(events.data_response_headers_Cache_Control_s),
data_request_parameters_param0_s=tostring(events.data_request_parameters_param0_s),
data_additionalDetails_namespace_s=tostring(events.data_additionalDetails_namespace_s),
data_response_headers_X_Content_Type_Options_s=tostring(events.data_response_headers_X_Content_Type_Options_s),
data_request_headers_Content_Length_s=tostring(events.data_request_headers_Content_Length_s),
data_request_headers_Content_Type_s=tostring(events.data_request_headers_Content_Type_s),
data_request_headers_x_content_sha256_s=tostring(events.data_request_headers_x_content_sha256_s),
data_request_headers_If_None_Match_s=tostring(events.data_request_headers_If_None_Match_s),
data_response_headers_Content_Encoding_s=tostring(events.data_response_headers_Content_Encoding_s),
data_request_parameters_includeSubcompartments_s=tostring(events.data_request_parameters_includeSubcompartments_s),
data_response_headers_opc_limit_s=tostring(events.data_response_headers_opc_limit_s),
data_request_headers_Date_s=tostring(events.data_request_headers_Date_s),
data_request_headers_opc_client_info_s=tostring(events.data_request_headers_opc_client_info_s),
data_request_parameters_endTime_s=tostring(events.data_request_parameters_endTime_s),
data_request_parameters_startTime_s=tostring(events.data_request_parameters_startTime_s),
data_response_headers_opc_next_page_s=tostring(events.data_response_headers_opc_next_page_s),
data_response_headers_opc_prev_page_s=tostring(events.data_response_headers_opc_prev_page_s),
data_identity_tenantId_s=tostring(events.data_identity_tenantId_s),
data_request_parameters_id_s=tostring(events.data_request_parameters_id_s),
data_request_parameters_name_s=tostring(events.data_request_parameters_name_s),
data_request_parameters_page_s=tostring(events.data_request_parameters_page_s),
data_request_parameters_streamPoolId_s=tostring(events.data_request_parameters_streamPoolId_s),
data_response_headers_opc_previous_page_s=tostring(events.data_response_headers_opc_previous_page_s),
data_response_payload_id_s=tostring(events.data_response_payload_id_s),
data_response_payload_resourceName_s=tostring(events.data_response_payload_resourceName_s),
data_request_headers_accept_language_s=tostring(events.data_request_headers_accept_language_s),
data_request_headers_authorization_s=tostring(events.data_request_headers_authorization_s),
data_response_headers_access_control_allow_credentials_s=tostring(events.data_response_headers_access_control_allow_credentials_s),
data_response_headers_access_control_allow_methods_s=tostring(events.data_response_headers_access_control_allow_methods_s),
data_response_headers_access_control_allow_origin_s=tostring(events.data_response_headers_access_control_allow_origin_s),
data_response_headers_access_control_expose_headers_s=tostring(events.data_response_headers_access_control_expose_headers_s),
data_response_headers_date_s=tostring(events.data_response_headers_date_s),
data_response_headers_x_api_id_s=tostring(events.data_response_headers_x_api_id_s),
data_request_parameters_lifecycleState_s=tostring(events.data_request_parameters_lifecycleState_s),
data_identity_principalId_s=tostring(events.data_identity_principalId_s),
data_identity_ipAddress_s=tostring(events.data_identity_ipAddress_s),
data_eventName_s=tostring(events.data_eventName_s),
data_stateChange_current_agentConfig_isMonitoringDisabled_b=tobool(events.data_stateChange_current_agentConfig_isMonitoringDisabled_b),
data_stateChange_current_agentConfig_pluginsConfig_s=tostring(events.data_stateChange_current_agentConfig_pluginsConfig_s),
data_stateChange_current_availabilityConfig_recoveryAction_s=tostring(events.data_stateChange_current_availabilityConfig_recoveryAction_s),
data_stateChange_current_availabilityDomain_s=tostring(events.data_stateChange_current_availabilityDomain_s),
data_stateChange_current_faultDomain_s=tostring(events.data_stateChange_current_faultDomain_s),
data_stateChange_current_imageId_s=tostring(events.data_stateChange_current_imageId_s),
data_stateChange_current_instanceOptions_areLegacyImdsEndpointsDisabled_b=tobool(events.data_stateChange_current_instanceOptions_areLegacyImdsEndpointsDisabled_b),
data_stateChange_current_launchMode_s=tostring(events.data_stateChange_current_launchMode_s),
data_stateChange_current_launchOptions_bootVolumeType_s=tostring(events.data_stateChange_current_launchOptions_bootVolumeType_s),
data_stateChange_current_launchOptions_firmware_s=tostring(events.data_stateChange_current_launchOptions_firmware_s),
data_stateChange_current_launchOptions_isConsistentVolumeNamingEnabled_b=tobool(events.data_stateChange_current_launchOptions_isConsistentVolumeNamingEnabled_b),
data_stateChange_current_launchOptions_isPvEncryptionInTransitEnabled_b=tobool(events.data_stateChange_current_launchOptions_isPvEncryptionInTransitEnabled_b),
data_stateChange_current_launchOptions_networkType_s=tostring(events.data_stateChange_current_launchOptions_networkType_s),
data_stateChange_current_launchOptions_remoteDataVolumeType_s=tostring(events.data_stateChange_current_launchOptions_remoteDataVolumeType_s),
data_stateChange_current_metadata_ssh_authorized_keys_s=tostring(events.data_stateChange_current_metadata_ssh_authorized_keys_s),
data_stateChange_current_region_s=tostring(events.data_stateChange_current_region_s),
data_stateChange_current_shape_s=tostring(events.data_stateChange_current_shape_s),
data_stateChange_current_shapeConfig_gpus_d=toreal(events.data_stateChange_current_shapeConfig_gpus_d),
data_stateChange_current_shapeConfig_localDisks_d=toreal(events.data_stateChange_current_shapeConfig_localDisks_d),
data_stateChange_current_shapeConfig_maxVnicAttachments_d=toreal(events.data_stateChange_current_shapeConfig_maxVnicAttachments_d),
data_stateChange_current_shapeConfig_memoryInGBs_d=toreal(events.data_stateChange_current_shapeConfig_memoryInGBs_d),
data_stateChange_current_shapeConfig_networkingBandwidthInGbps_d=toreal(events.data_stateChange_current_shapeConfig_networkingBandwidthInGbps_d),
data_stateChange_current_shapeConfig_ocpus_d=toreal(events.data_stateChange_current_shapeConfig_ocpus_d),
data_stateChange_current_shapeConfig_processorDescription_s=tostring(events.data_stateChange_current_shapeConfig_processorDescription_s),
data_stateChange_current_sourceDetails_imageId_s=tostring(events.data_stateChange_current_sourceDetails_imageId_s),
data_stateChange_current_sourceDetails_sourceType_s=tostring(events.data_stateChange_current_sourceDetails_sourceType_s),
data_stateChange_current_systemTags_orcl_cloud_s=tostring(events.data_stateChange_current_systemTags_orcl_cloud_s),
data_request_parameters_instanceId_s=tostring(events.data_request_parameters_instanceId_s),
data_request_headers_opc_retry_token_s=tostring(events.data_request_headers_opc_retry_token_s),
data_stateChange_current_agentConfig_isManagementDisabled_b=tobool(events.data_stateChange_current_agentConfig_isManagementDisabled_b),
data_stateChange_current_agentConfig_areAllPluginsDisabled_b=tobool(events.data_stateChange_current_agentConfig_areAllPluginsDisabled_b),
data_additionalDetails_volumeId_s=tostring(events.data_additionalDetails_volumeId_s),
data_additionalDetails_type_s=tostring(events.data_additionalDetails_type_s),
data_flowid_s=tostring(events.data_flowid_s),
data_startTime_d=toreal(events.data_startTime_d),
data_status_s=tostring(events.data_status_s),
data_version_s=tostring(events.data_version_s),
id_s=tostring(events.id_s),
oracle_logid_s=tostring(events.oracle_logid_s),
oracle_vniccompartmentocid_s=tostring(events.oracle_vniccompartmentocid_s),
oracle_vnicocid_s=tostring(events.oracle_vnicocid_s),
oracle_vnicsubnetocid_s=tostring(events.oracle_vnicsubnetocid_s),
data_action_s=tostring(events.data_action_s),
data_bytesOut_d=toreal(events.data_bytesOut_d),
data_destinationAddress_s=tostring(events.data_destinationAddress_s),
data_destinationPort_d=toreal(events.data_destinationPort_d),
data_packets_d=toreal(events.data_packets_d),
data_additionalDetails_isFreeTier_b=tobool(events.data_additionalDetails_isFreeTier_b),
data_protocol_d=toreal(events.data_protocol_d),
data_sourceAddress_s=tostring(events.data_sourceAddress_s),
data_sourcePort_d=toreal(events.data_sourcePort_d),
data_request_parameters_serviceName_s=tostring(events.data_request_parameters_serviceName_s),
data_request_parameters_vcnId_s=tostring(events.data_request_parameters_vcnId_s),
data_request_parameters_imageId_s=tostring(events.data_request_parameters_imageId_s),
data_request_parameters_operatingSystem_s=tostring(events.data_request_parameters_operatingSystem_s),
data_request_parameters_operatingSystemVersion_s=tostring(events.data_request_parameters_operatingSystemVersion_s),
data_request_parameters_shape_s=tostring(events.data_request_parameters_shape_s),
data_request_parameters_isMergeEnabled_s=tostring(events.data_request_parameters_isMergeEnabled_s),
data_identity_callerId_s=tostring(events.data_identity_callerId_s),
data_identity_callerName_s=tostring(events.data_identity_callerName_s),
data_request_headers_opc_obo_token_s=tostring(events.data_request_headers_opc_obo_token_s),
data_additionalDetails_imageId_s=tostring(events.data_additionalDetails_imageId_s),
data_additionalDetails_shape_s=tostring(events.data_additionalDetails_shape_s),
data_protocolName_s=tostring(events.data_protocolName_s),
data_request_parameters_subnetId_s=tostring(events.data_request_parameters_subnetId_s),
data_stateChange_current_Instance_agentConfig_s=tostring(events.data_stateChange_current_Instance_agentConfig_s),
data_stateChange_current_Instance_availabilityDomain_s=tostring(events.data_stateChange_current_Instance_availabilityDomain_s),
data_stateChange_current_lifecycleDetails_s=tostring(events.data_stateChange_current_lifecycleDetails_s),
data_stateChange_current_lifecyleDetails_s=tostring(events.data_stateChange_current_lifecyleDetails_s),
data_stateChange_current_tenancyId_s=tostring(events.data_stateChange_current_tenancyId_s),
data_stateChange_current_timeUpdated_t=todatetime(events.data_stateChange_current_timeUpdated_t),
data_stateChange_current_userDisplayName_s=tostring(events.data_stateChange_current_userDisplayName_s),
data_stateChange_current_userName_s=tostring(events.data_stateChange_current_userName_s),
data_request_headers_oci_splat_generated_ocids_s=tostring(events.data_request_headers_oci_splat_generated_ocids_s),
data_response_headers_opc_work_request_id_s=tostring(events.data_response_headers_opc_work_request_id_s),
data_stateChange_current_configuration_s=tostring(events.data_stateChange_current_configuration_s),
data_stateChange_current_definedTags_s=tostring(events.data_stateChange_current_definedTags_s),
data_stateChange_current_freeformTags_s=tostring(events.data_stateChange_current_freeformTags_s),
data_stateChange_current_isEnabled_s=tostring(events.data_stateChange_current_isEnabled_s),
data_stateChange_current_logGroupId_s=tostring(events.data_stateChange_current_logGroupId_s),
data_stateChange_current_logType_s=tostring(events.data_stateChange_current_logType_s),
data_stateChange_current_retentionDuration_s=tostring(events.data_stateChange_current_retentionDuration_s),
data_stateChange_current_timeCreated_s=tostring(events.data_stateChange_current_timeCreated_s),
data_stateChange_current_timeLastModified_s=tostring(events.data_stateChange_current_timeLastModified_s),
data_request_headers_Cache_Control_s=tostring(events.data_request_headers_Cache_Control_s),
data_request_headers_Cookie_s=tostring(events.data_request_headers_Cookie_s),
data_request_headers_Sec_Fetch_User_s=tostring(events.data_request_headers_Sec_Fetch_User_s),
data_request_headers_Upgrade_Insecure_Requests_s=tostring(events.data_request_headers_Upgrade_Insecure_Requests_s),
data_response_headers_X_FRAME_OPTIONS_s=tostring(events.data_response_headers_X_FRAME_OPTIONS_s),
data_additionalDetails_id_s=tostring(events.data_additionalDetails_id_s),
data_availabilityDomain_s=tostring(events.data_availabilityDomain_s),
data_compartmentId_s=tostring(events.data_compartmentId_s),
data_compartmentName_s=tostring(events.data_compartmentName_s),
data_definedTags_Oracle_Tags_CreatedBy_s=tostring(events.data_definedTags_Oracle_Tags_CreatedBy_s),
data_definedTags_Oracle_Tags_CreatedOn_t=todatetime(events.data_definedTags_Oracle_Tags_CreatedOn_t),
data_eventGroupingId_s=tostring(events.data_eventGroupingId_s),
data_stateChange_current_instanceId_s=tostring(events.data_stateChange_current_instanceId_s),
data_stateChange_current_id_s=tostring(events.data_stateChange_current_id_s),
data_stateChange_current_displayName_s=tostring(events.data_stateChange_current_displayName_s),
data_stateChange_current_definedTags_Oracle_Tags_s=tostring(events.data_stateChange_current_definedTags_Oracle_Tags_s),
data_stateChange_current_Instance_compartmentId_s=tostring(events.data_stateChange_current_Instance_compartmentId_s),
data_stateChange_current_Instance_definedTags_s=tostring(events.data_stateChange_current_Instance_definedTags_s),
data_stateChange_current_Instance_displayName_s=tostring(events.data_stateChange_current_Instance_displayName_s),
data_stateChange_current_Instance_extendedMetadata_s=tostring(events.data_stateChange_current_Instance_extendedMetadata_s),
data_stateChange_current_Instance_faultDomain_s=tostring(events.data_stateChange_current_Instance_faultDomain_s),
data_stateChange_current_Instance_freeformTags_s=tostring(events.data_stateChange_current_Instance_freeformTags_s),
data_stateChange_current_Instance_id_s=tostring(events.data_stateChange_current_Instance_id_s),
data_stateChange_current_Instance_imageId_s=tostring(events.data_stateChange_current_Instance_imageId_s),
data_stateChange_current_Instance_instanceOptions_s=tostring(events.data_stateChange_current_Instance_instanceOptions_s),
data_stateChange_current_Instance_launchMode_s=tostring(events.data_stateChange_current_Instance_launchMode_s),
data_stateChange_current_Instance_launchOptions_s=tostring(events.data_stateChange_current_Instance_launchOptions_s),
data_stateChange_current_Instance_lifecycleState_s=tostring(events.data_stateChange_current_Instance_lifecycleState_s),
data_stateChange_current_Instance_metadata_s=tostring(events.data_stateChange_current_Instance_metadata_s),
data_stateChange_current_Instance_region_s=tostring(events.data_stateChange_current_Instance_region_s),
data_stateChange_current_Instance_availabilityConfig_s=tostring(events.data_stateChange_current_Instance_availabilityConfig_s),
data_stateChange_current_Instance_shape_s=tostring(events.data_stateChange_current_Instance_shape_s),
data_stateChange_current_Instance_sourceDetails_s=tostring(events.data_stateChange_current_Instance_sourceDetails_s),
data_stateChange_current_Instance_systemTags_s=tostring(events.data_stateChange_current_Instance_systemTags_s),
data_stateChange_current_Instance_timeCreated_t=todatetime(events.data_stateChange_current_Instance_timeCreated_t),
data_stateChange_current_subnetIds_s=tostring(events.data_stateChange_current_subnetIds_s),
data_stateChange_current_syslogUrl_s=tostring(events.data_stateChange_current_syslogUrl_s),
data_stateChange_current_traceConfig_domainId_s=tostring(events.data_stateChange_current_traceConfig_domainId_s),
data_stateChange_current_traceConfig_isEnabled_b=tobool(events.data_stateChange_current_traceConfig_isEnabled_b),
data_response_headers_Content_Security_Policy_s=tostring(events.data_response_headers_Content_Security_Policy_s),
data_response_headers_Etag_s=tostring(events.data_response_headers_Etag_s),
data_response_headers_Opc_Request_Id_s=tostring(events.data_response_headers_Opc_Request_Id_s),
data_response_headers_Strict_Transport_Security_s=tostring(events.data_response_headers_Strict_Transport_Security_s),
data_response_headers_X_Frame_Options_s=tostring(events.data_response_headers_X_Frame_Options_s),
data_response_headers_X_Xss_Protection_s=tostring(events.data_response_headers_X_Xss_Protection_s),
data_stateChange_current_compartmentId_s=tostring(events.data_stateChange_current_compartmentId_s),
data_stateChange_current_Instance_shapeConfig_s=tostring(events.data_stateChange_current_Instance_shapeConfig_s),
data_response_headers_oci_splat_authorization_verify_content_s=tostring(events.data_response_headers_oci_splat_authorization_verify_content_s),
_TimeReceived=todatetime(now())
}

.alter table OCI_Logs_CL policy update @'[{"Source": "OCI_Logs_CLRaw", "Query": "OCI_Logs_CLExpand()", "IsEnabled": "True", "IsTransactional": true}]'
